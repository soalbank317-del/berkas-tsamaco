<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>TSAMACO - Arsip File</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#f5f5f5; --card:#ffffff; --accent:#00c853; --accent-dark:#009624;
  --muted:#666; --text:#222; --highlight:#ffe57f;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
  background:var(--bg);
  min-height:100vh;
  display:flex; justify-content:center; padding:24px;
}
.wrap{
  width:100%; max-width:1200px;
  display:flex; flex-direction:column; align-items:center;
}
.head{
  text-align:center; margin-bottom:24px;
}
.logo{
  width:80px; height:80px; border-radius:16px;
  background:var(--accent); display:flex; align-items:center; justify-content:center;
  color:white; font-size:36px; font-weight:700; margin:0 auto 12px;
  box-shadow:0 6px 18px rgba(0,200,83,0.3);
}
h1{ font-size:28px; text-transform:uppercase; color:var(--text); margin-bottom:4px; letter-spacing:1px;}
.sub{ color:var(--muted); font-size:16px; margin-bottom:20px;}
.search-bar{
  width:100%; max-width:600px; margin-bottom:24px;
  display:flex; align-items:center;
  background:white; border-radius:16px; padding:6px 10px;
  box-shadow:0 4px 12px rgba(0,0,0,0.08);
}
.search-bar input{
  flex:1; border:none; outline:none; font-size:15px; padding:12px 14px; border-radius:16px;
}
.search-bar input:focus{ box-shadow:0 0 0 2px var(--accent); }

.results{
  width:100%; margin-top:10px;
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:16px;
}
@media(max-width:1200px){ .results{ grid-template-columns:repeat(4,1fr);} }
@media(max-width:1000px){ .results{ grid-template-columns:repeat(3,1fr);} }
@media(max-width:700px){ .results{ grid-template-columns:repeat(2,1fr);} }
@media(max-width:500px){ .results{ grid-template-columns:1fr;} }

.card{
  display:flex; flex-direction:column; align-items:center; text-align:center;
  background:var(--card); border-radius:16px;
  padding:20px;
  box-shadow:0 4px 12px rgba(0,0,0,0.06);
  transition: transform 0.25s ease, box-shadow 0.25s ease;
  cursor:pointer;
}
.card:hover{ transform:translateY(-5px) scale(1.03); box-shadow:0 12px 28px rgba(0,0,0,0.14);}
.card:active{ transform:scale(0.97); box-shadow:0 6px 16px rgba(0,0,0,0.1);}
.symbol{
  font-size:40px; margin-bottom:12px; transition: transform 0.25s ease;
}
.mapel{ font-weight:600; color:var(--text); margin-bottom:6px; word-break:break-word; font-size:14px;}
.badge{ font-size:12px; color:var(--muted); margin-bottom:6px;}
.btn.open{
  padding:6px 16px; border-radius:12px; border:0;
  background:var(--accent); color:white; font-weight:600; text-decoration:none;
  transition:0.2s;
}
.btn.open:hover{ background:var(--accent-dark); }
.empty{text-align:center;color:var(--muted); padding:48px 0; font-size:16px;}
mark.hi{ background:var(--highlight); padding:0 .15em; border-radius:4px;}
footer{ margin-top:28px; text-align:center; color:var(--muted); font-size:13px;}
</style>
</head>
<body>
<div class="wrap">
  <div class="head">
    <div class="logo">TA</div>
    <h1>TSAMACO</h1>
    <div class="sub">Arsip MTs Amtsilati - Persiapan Tsamaco</div>
  </div>

  <div class="search-bar">
    <input id="q" placeholder="Cari nama file...">
  </div>

  <div id="results" class="results" aria-live="polite"></div>
  <footer id="footer">@pacegondes <strong>2025</strong></footer>
</div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT1s3KCGJWMcqWQkTppTXiuZMxxFUPJVLIxttNtOFRg2tzDT7kDeWxOyVofc8Fa7-PAQj8IiLD_S1Sw/pub?output=csv";
let all = [];

function parseCSV(text){
  const rows = text.split(/\r?\n/).filter(r=>r.trim()!=="");
  if(!rows.length) return [];
  const header = rows.shift().split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(h=>h.trim().toLowerCase());
  const idx = {
    nama: header.indexOf("nama file"),
    link: header.indexOf("link file"),
    ikon: header.indexOf("ikon"),
    size: header.indexOf("ukuran"),
    date: header.indexOf("tanggal"),
    cat: header.indexOf("kategori")
  };
  return rows.map(line=>{
    const cols = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(c=>c.replace(/^"|"$/g,'').trim());
    return {
      nama: cols[idx.nama] || "Untitled",
      link: cols[idx.link] || "#",
      ikon: cols[idx.ikon] || "",
      size: cols[idx.size] || "-",
      date: cols[idx.date] || "-",
      category: cols[idx.cat] || "-"
    };
  });
}

const FILE_ICONS = { pdf:"📄", doc:"📄", docx:"📄", xls:"📊", xlsx:"📊", zip:"🗜️", ppt:"📈",
  "Al-Qur'an Hadits":"📖","Akidah Ahlak":"👳‍♂️","Bahasa Arab":"📝"
};

function detectIcon(name,csvIcon){
  if(csvIcon && csvIcon.trim()) return csvIcon.trim();
  return FILE_ICONS[name] || "⭐";
}

function highlight(text,q){
  if(!q) return text;
  const esc = q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&');
  const re = new RegExp(esc,'ig');
  return text.replace(re, m=>`<mark class="hi">${m}</mark>`);
}

function escapeAttr(s){ return s?s.replace(/"/g,'&quot;'):''; }

function render(){
  const q = document.getElementById('q').value.trim().toLowerCase();
  const cont = document.getElementById('results');
  cont.innerHTML = "";

  const filtered = all.filter(f=>f.nama.toLowerCase().includes(q));

  if(!filtered.length){ cont.innerHTML='<div class="empty">Tidak ada file yang cocok.</div>'; return; }

  filtered.forEach(it=>{
    const icon = detectIcon(it.nama,it.ikon);
    const card = document.createElement('div');
    card.className='card';
    card.innerHTML = `
      <div class="symbol">${icon}</div>
      <div class="mapel">${highlight(it.nama,q)}</div>
      <div class="badge">${it.size}</div>
      <div class="badge">${it.date}</div>
      <a class="btn open" href="${escapeAttr(it.link)}" target="_blank" rel="noopener">Buka</a>
    `;
    // Animasi klik tambahan
    card.addEventListener('mousedown',()=>{ card.style.transform='scale(0.97)'; });
    card.addEventListener('mouseup',()=>{ card.style.transform='scale(1)'; });
    card.addEventListener('mouseleave',()=>{ card.style.transform='scale(1)'; });
    cont.appendChild(card);
  });

  document.getElementById('footer').textContent = `Menampilkan ${filtered.length} file | @pacegondes 2025`;
}

async function load(){
  try{
    const res = await fetch(CSV_URL);
    if(!res.ok) throw new Error('Fetch error: '+res.status);
    const text = await res.text();
    all = parseCSV(text);
    all.sort((a,b)=>a.nama.localeCompare(b.nama));
    render();
  }catch(err){
    document.getElementById('results').innerHTML=`<div class="empty">Gagal mengambil data: ${err.message}</div>`;
    console.error(err);
  }
}

document.getElementById('q').addEventListener('input', render);
load();
</script>
</body>
</html>


